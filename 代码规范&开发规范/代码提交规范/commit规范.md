## 一、commit指引
通过标准的提交信息，让提交记录更具可读性，方便查找变更。在制定标准的同时，尽量保持提交信息的简单，减少编写占用的时间。此处commit信息规范，适用于前端代码提交，不区分代码提交工具、代码review平台，git与svn均适用。

此前在vt的项目已有提交信息规范，如aCMP项目、混合云项目，然而不够完善。代码提示规范代码改动类型少，不能很好地适应前端日常开发的需求。混合云项目代码提交规范，借鉴了Angular项目规范，由于Anglular不进行业务开发，提交类型较简单，在提交代码时类型不能切实符合提交内容。这里根据实际的业务开发情况，对现有提交规范进行了整理、扩充。

commit提交的信息可通过commit template进行设置，详见[commit 模板](#三commit模板)。

commit信息与合并请求信息是一致的，commit信息中的改动类型适用于分支命名。即commit信息与合并请求信息，使用同一套规则。而分支命名规范中的类型与commit信息的类型保持一致，只需要进行简单转换即可。

**请始终使用GUI工具提交代码，提交前对比文件改动，只提交真正需要提交的代码！**


## 二、commit信息
commit信息使用markdown编写，每条信息格式如下。[查看示例](#五示例)

```
[改动类型][改动范围][改动范围...] BUG ID/#ISSUE ID 概要

问题分析：
1. 分析点1
2. 分析点2

改动说明：
1. 改动点1
2. 改动点2

性能指标：
1. 性能指标说明

测试：
1. 测试点1
2. 测试点2

兼容性：
1. ie 8 -- 结果/无
2. ie 9 -- 结果/无
3. ie 10 -- 结果/无
4. ie11 -- 结果/无
3. firefox -- 结果/无
4. chrome -- 结果/无

待处理问题：
1. 待处理问题1
2. 待处理问题2

其他自定义信息，如关联的内容：
1. 其他信息1
2. 其他信息2
```

### 改动类型（必选）
改动类型表明，当前提交内容是何种类型的改动。开发过程中常用的只有几项，语义简单，容易记忆。
* **feature**：新增一个功能。如果是需要对接但未对接的功能，在待处理问题中记录
* **joint**：与后端对接，或前端多个模块间对接。根据开发经验，编码与对接可能并不连续
* **fix**：修改问题记录，修改的是TD或gitlab的问题，提交必须带上TD ID或ISSUE ID
* **style**：视觉样式的修改，不涉及逻辑的变更。根据开发经验，视觉实现与功能实现可能并不连续
* **code**：修改代码规范问题，代码扫描错误等，如代码review中提出的问题，正常情况下一般不会作为一个单独的合入
* **update**：代码更新，其他类型不适用时使用。一般是修改同一问题第一次之后的提交
* **sync**：同步公共组件代码，或者合并其他分支的代码
* **perf**：性能优化。业务开发过程容易忽略了性能问题，看类无问题在代码，在低版本浏览器、及数据量大的情况下便会暴露
* **refactor**：整个文件、模块以上规模的代码重构
* **build**：修改构建相关的内容，如Makefile、webpack、eslint配置等
* **ci**：修改ci配置，如流水线
* **test**：补充测试
* **docs**：文档内容的修改

_注意：fix类型是一个前缀，用于表明当前提交是处理问题而非功能开发，具体修改内容使用其他类型表示。如修改的内容是样式，则使用`[fix-style]`；如果修改的内容是代码规范问题，则使用`[fix-code]`；其他情况类推。如果没有对应的项则不填写。_

### 改动范围（必选）
改动范围表明改动内容主要的影响范围，描述清楚即可，一般需要具体到页面或弹窗。如修改云主机详情的日志页面，改动范围不能为[云主机]，应该写[云主机详情-日志]，如果有**多个不同维度**的改动范围，每个维度均可使用一个[改动范围]进行表示。**改动范围直接使用中文进行描述，方便直观**。
* 模块：主要修改的模块，主要在业务开发中使用，如 [云主机列表]、[个人设置]。多个不同维度的改动范围，表示为 **[admin][系统设置]、[admin][云主机列表]、[admin、租户][云主机列表]、[用户][云主机列表]**。如果没有多个范围，则表示所有的，如**[云主机列表]等同于[admin、租户、用户][云主机列表]**。
* 所有页面：影响所有页面的改动，如修改全局依赖的数据
* 组件：主要是在修改公共组件的场景使用，如 [sf-select]

### 概要（必选）
描述修改的概要信息，要具体，一眼能看出修改的具体内容，不能太抽象。

错误的示例：
* 新增需求
* 云主机修改
* 对接功能

正确的示例：
* 添加新建云主机窗口
* 添加新建数据库-网络配置步骤
* 对接云主机编辑标签窗口
* 修改变量未定义等问题

### 问题分析
主要用在BUG，ISSUE时，其他类型根据实际情况确定是否需要。

### 改动说明
这些提交主要修改了什么问题，修改同一问题的第一个提交必须带上改动说明。修改规范类型的问题可以选择不写。

### 性能指标
根据实际情况决定是否需要，主要考虑数据量、节点数据、DOM操作、事件的调用频度等。编写公共组件需要特别注意。

### 完成的测试（必选）
修改问题时编写具体的测试步骤，以及测试结果。结果需要描述修改后观察到的表现。

错误的示例：
* 测试无问题
* 开机按钮不应该置灰
* 关机按钮应该置灰

正确的示例：
* 云主机磁盘类型显示正确
* 关机状态的云主机，开机按钮被置灰
* 切换到系统设置标签页后，系统维护里的表格刷新请求被停止

### 兼容性测试（新功能必选）
根据实际情况添加，无该项描述，表示未进行除chrome外的兼容性测试。开发**新功能**，**合入前**必须进行兼容性测试，该项必须填写，但可选择填写在commit信息，或者合入信息。建议在commit信息里填好，然后将commit信息复制到合并信息。

_注意：登录界面需要进行不兼容的浏览器测试，保证能正常显示不兼容信息！_


### 待处理问题
已知的待处理问题，根据实际情况填写

### 其他自定义信息
其他任何自定义信息

**代码review人员在reivew时，需要关注以上提到的项。如果必选项缺失，则先补完才能合入！其他非必选项根据提交的代码，决定是否需要补充！**


## 三、commit模板
git、svn支持设置代码提交模板。由于规范比较简单，项目少，此处略~


## 四、精简commit信息
_以下内容适用于git_

在开发一个任务的过程中，同一分支，可能会进行多次commit。而很多commit，只是为了修正以往commit的问题，或者只是临时保存当前代码。当这些commit合入主开发分支，查看git log，会发现很多无用的commit记录，不便于查找代码改动。

存在两种方式进行commit合并，详见[合并多次commit](合并多次commit.md)


## 五、示例
代码提交信息示例

### 1. 开发aCMP跳转访问aCloud平台的功能
分支名称： `feature/cluster-list-acloud-proxy`
```
[feature][集群列表] 添加代理访问aCloud平台功能

改动说明：
1. 集群列表添加登入链接，只有aCloud云主机才能点击跳转

测试：
1. aCloud云主机可以点击，点击跳转到时aCloud界面，显示、操作正常
2. vmware云主机，链接被置灰，不可点击

待处理问题：
1. 本地调通，待对接

```

### 2. 代码review问题修改
分支名称：理论上跟第一次提交是同一个分支，即示例1的中的分支名称。如果是单独的修改，则分支名称为 `code/cluster-list-remove-useless-var`
```
[code][集群列表] 未使用的变量去除


测试：
1. eslint代码扫描通过

```

### 3. 功能对接
分支名称：`joint/cluster-list-acloud-proxy`。

_注意：集群列表只在admin下存在，所以[集群列表]相当于[admin][集群列表]，[admin]直接省略即可。对于[云主机列表]这种存在于不同页面的模块，应该写明修改的是哪个模块里的云主机列表！_
```
[joint][集群列表] 与后端对接aCMP代理访问aCloud页面功能

测试：
1. aCloud云主机可以点击，点击跳转到时aCloud界面，显示、操作正常
2. vmware云主机，链接被置灰，不可点击

```

### 4. 样式修改
分支名称： ``
```
[style] [容灾-链路] 编辑窗口样式修改

改动说明：
1. 编辑的form由`sf-flex`改为`sf-col`，两列均分，减少padding
2. 去除指引图的文本
3. 加密传输说明放在右侧
4. 替换指引图

测试：
1.表单、图片显示正常

```

### 5. 修改TD BUG 43594
分支名称：`fix/43594-login-page-ie10-compatible`
```
[fix][登录页面] TD 43594，ie10浏览器未显示浏览器未支持的提示信息

问题分析：
1. 新加序列号需求时，使用了ie8不兼容es5的特性
2. 使用了jquery 2版本，不支持ie8

改动说明：
1. 直接将登录页面使用的3个文件放置到登录目录下，由于win下软链接存在兼容问题，并非所有win及用户配置都支持，所以直接拷贝文件
2. 登录页面使用jquery 1版本
3. 另没必要仅为了兼容ie8，引入shim，以及修改构建配置以将不支持的代码转换成es3！简单修改登录页面即可

测试：
1. chrome浏览器登录正常

兼容性：
1. ie 8 -- 显示不兼容的页面提示
2. ie 9 -- 显示不兼容的页面提示
3. ie 10 -- 不提示
4. ie11 -- 不提示
3. firefox -- 不提示
4. chrome -- 不提示
```

### 6. 修改样式BUG
分支名称：`fix/#48-style-enlarge-resouce-label-width`
```
[fix-style][租户][首页] #48 增大云主机和资源配额子项目label宽度

改动说明：
1. 租户-首页，云主机子项目label单词过长，显示了两排，增加宽度

测试:
1. 租户-首页，云主机子项目label正常显示成一排

```

### 7. 从其他分支同步代码（如从5.8.6合入代码到5.8.6英文版）
分支名称： `sync/merge-from-5.8.6`
```
[sync] 合并5.8.6代码到5.8.6_EN

测试：
1. sfix deploy -p -c --product 打包正常
```






